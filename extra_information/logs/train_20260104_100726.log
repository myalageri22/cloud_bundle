2026-01-04 10:07:26 VascularSeg INFO Logging initialized. Log file: /Users/prade/U-NET-ISEF/cloud_bundle/logs/train_20260104_100726.log
2026-01-04 10:07:26 VascularSeg INFO Starting vascular segmentation training pipeline
2026-01-04 10:07:26 VascularSeg INFO Experiment: 20260104_100726
2026-01-04 10:07:26 VascularSeg INFO Device: mps
2026-01-04 10:07:26 VascularSeg INFO Dataset preset=custom dataset=custom
2026-01-04 10:07:26 VascularSeg INFO PyTorch version: 2.8.0
2026-01-04 10:07:26 VascularSeg INFO CUDA available: False
2026-01-04 10:07:26 VascularSeg INFO MPS status - built: True, available: True
2026-01-04 10:07:26 VascularSeg INFO Model compilation (torch.compile): True
2026-01-04 10:07:26 VascularSeg INFO DataLoader workers: 8 (prefetch=2, persistent=True)
2026-01-04 10:07:26 VascularSeg INFO 
2026-01-04 10:07:26 VascularSeg INFO 1. dataset discovery
2026-01-04 10:07:26 VascularSeg INFO Scanning dataset under /Users/prade/U-NET-ISEF/cloud_bundle
2026-01-04 10:07:27 VascularSeg INFO Total samples found: 1000
2026-01-04 10:07:27 VascularSeg INFO   id=1 image=/Users/prade/U-NET-ISEF/cloud_bundle/data/processed/all/1-200/1.img.nii.gz label=/Users/prade/U-NET-ISEF/cloud_bundle/data/processed/all/1-200/1.label.nii.gz
2026-01-04 10:07:27 VascularSeg INFO   id=2 image=/Users/prade/U-NET-ISEF/cloud_bundle/data/processed/all/1-200/2.img.nii.gz label=/Users/prade/U-NET-ISEF/cloud_bundle/data/processed/all/1-200/2.label.nii.gz
2026-01-04 10:07:27 VascularSeg INFO   id=3 image=/Users/prade/U-NET-ISEF/cloud_bundle/data/processed/all/1-200/3.img.nii.gz label=/Users/prade/U-NET-ISEF/cloud_bundle/data/processed/all/1-200/3.label.nii.gz
2026-01-04 10:07:29 VascularSeg INFO Sanity sample id=1 -> image shape (512, 512, 275) (min -1024.0000 max 3071.0000), label shape (512, 512, 275) (min 0.0000 max 1.0000)
2026-01-04 10:07:29 VascularSeg INFO 
2026-01-04 10:07:29 VascularSeg INFO 2. dataset split
2026-01-04 10:07:29 VascularSeg INFO Using existing split from /Users/prade/U-NET-ISEF/cloud_bundle/splits.json (train=700, val=50, test=250)
2026-01-04 10:07:29 VascularSeg INFO 
2026-01-04 10:07:29 VascularSeg INFO 3. building data loaders
2026-01-04 10:07:31 VascularSeg INFO Creating training dataset (cache_rate=0.25)...
2026-01-04 10:10:32 VascularSeg INFO Training dataset ready in 181.4s
2026-01-04 10:10:32 VascularSeg INFO Creating validation dataset (cache_rate=1.00)...
2026-01-04 10:11:20 VascularSeg INFO Validation dataset ready in 47.9s
2026-01-04 10:11:20 VascularSeg INFO   Train batches: 350
2026-01-04 10:11:20 VascularSeg INFO   Val batches: 50
2026-01-04 10:11:20 VascularSeg INFO 
2026-01-04 10:11:20 VascularSeg INFO 4. model initialization
2026-01-04 10:11:21 VascularSeg WARNING MPS compilation unstable; skipping
2026-01-04 10:11:21 VascularSeg INFO Model parameters:
2026-01-04 10:11:21 VascularSeg INFO   Total: 28,650,933
2026-01-04 10:11:21 VascularSeg INFO   Trainable: 28,650,933
2026-01-04 10:11:21 VascularSeg INFO   Size: ~109.3 MB (FP32)
2026-01-04 10:11:21 VascularSeg INFO 
2026-01-04 10:11:21 VascularSeg INFO 5. loss function and metrics
2026-01-04 10:11:21 VascularSeg INFO Computing class weights from training data...
2026-01-04 10:15:49 VascularSeg INFO   Positive voxels: 78,936,341
2026-01-04 10:15:49 VascularSeg INFO   Negative voxels: 47,202,404,075
2026-01-04 10:15:49 VascularSeg INFO   Ratio (neg/pos): 200.00
2026-01-04 10:15:49 VascularSeg INFO   pos_weight = 200.00
2026-01-04 10:15:49 VascularSeg INFO Loss: 40% Dice + 40% Focal + 20% Tversky
2026-01-04 10:15:49 VascularSeg INFO Metrics: Dice Score, Hausdorff Distance (95th percentile)
2026-01-04 10:15:49 VascularSeg INFO 
2026-01-04 10:15:49 VascularSeg INFO 6. optimizer and scheduler
2026-01-04 10:15:50 VascularSeg INFO Scheduler: Warmup (875 steps) + CosineAnnealing
2026-01-04 10:15:50 VascularSeg INFO 
2026-01-04 10:15:50 VascularSeg INFO 7. training loop
2026-01-04 10:15:50 VascularSeg INFO No checkpoint resume requested; starting from scratch.
